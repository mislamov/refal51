/* программа по распознаванию морфологии слов руссского языка */
/* по окончанию и приставке слова */
/* язык программирования РЕФАЛ 5 */
/* автор Ермолаев Д.С. www.icreator.ru */
/* ввод одного слова с консоли */

$ENTRY Go { =   <Prout <Question (<Card>) >>; };

/* таблица1. слова, которые имеют неправильное окончание */
WordsMissTable { =
        ( ('сел') 'сесть' )
        ( ('рек') 'река' )
        ( ('кровать') 'кровать' )
        ( ('скоро') 'скоро' )
}

/* таблица2. окончания, по которым можно определить основу */
CompletionTable { =
                /* для глаголов */
        ( ('нули') 'ать')
        ( ('нул') 'ать')
        ( ('ает') 'ать')
        ( ('еть') 'ать')
        ( ('еч') 'ать')
        ( ('ал') 'ать')
        ( ('ел') 'ать')
        /* для прилагательных */
        ( ('вые') 'вый')
        ( ('вая') 'вый')
        ( ('ая') 'ой')
        ( ('ие') 'ой')
        ( ('ую') 'ой')
};

/* сама программа распознавания морфологической формы слова */
Question {
        /* берем слово и ищем подходящее по шаблону в таблице1 */
        (e.Word), <WordsMissTable>: e.L((e.Word)e.Qst)e.R = e.Qst;
        /* иначе, берём окончание слова и ищем по шаблону в таблице2 */
        (e.x1 e.End), <CompletionTable>: e.L((e.End)e.Qst)e.R = e.x1 e.Qst ;
        /* иначе, слово неизменяемо */
        (e.x1) = e.x1
}
